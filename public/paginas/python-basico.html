<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python Masterclass: Ciência de Dados na Prática | DAnalise</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Fira+Code&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../styles.css">
    <link rel="stylesheet" href="page-styles.css">
    <style>
        .page-title-section.avancado-theme {
            background: var(--avancado-light);
            border-color: var(--avancado);
        }

        .content-section h2 {
            color: var(--avancado);
            border-color: var(--avancado-light);
        }

        .back-link:hover {
            color: var(--avancado);
        }

        .step-list li::before {
            background: var(--avancado);
        }

        .table-example th {
            background: var(--avancado);
        }

        .formula-display {
            color: var(--avancado);
        }

        .nav-bottom a:hover {
            border-color: var(--avancado);
        }
    </style>
    <link rel="icon" href="../assets/logo-circle.png" type="image/png">
</head>

<body>
    <div id="subpage-theme-toggle" class="theme-toggle"
        style="position: absolute; top: 2rem; right: 2rem; z-index: 100;">
        <img id="theme-icon-img" src="../assets/moon-white.png" alt="Alternar Tema" style="width: 20px; height: 20px;">
    </div>
    <main class="content-page">
        <a href="../index.html#avancado" class="back-link">[<] Voltar para Modulo 4 - Avancado</a>

                <div class="page-title-section avancado-theme">
                    <h1>Python Masterclass: Arquitetura de Dados e Automação</h1>
                    <p class="subtitle">Vá além do script básico. Entenda como o Python gerencia memória, processa
                        vetores com NumPy/Pandas e automatiza tarefas que levariam horas.</p>
                </div>

                <!-- CAPÍTULO 1: ARQUITETURA PYTHON -->
                <section class="content-section">
                    <h2>1. Como o Python Pensa (Interpretador vs Compilador)</h2>
                    <p>Python é uma linguagem interpretada de alto nível. Isso significa que você escreve em inglês
                        ("print", "if") e um tradutor em tempo real converte isso para zeros e uns.</p>

                    <h3>O Custo da Facilidade</h3>
                    <p>Por ser interpretado, o Python puro é lento para <em>loops</em> gigantes (processar 1 bilhão de
                        linhas num loop <code>for</code> demoraria horas). É aqui que entra a mágica das bibliotecas.
                    </p>

                    <div class="curiosity-box">
                        <h4>💡 O Segredo do C</h4>
                        <p>Bibliotecas como <strong>NumPy</strong> e <strong>Pandas</strong> não são escritas em Python
                            puro. Elas são escritas em <strong>C</strong> (linguagem de baixo nível super rápida).
                            Quando você chama <code>df.sum()</code> no Pandas, o Python apenas "aperta o botão" e o
                            código C super-otimizado roda por baixo. É por isso que Data Science em Python é rápido: o
                            Python é o gerente, o C é o operário.</p>
                    </div>
                </section>

                <!-- CAPÍTULO 2: PANDAS E VETORIZAÇÃO -->
                <section class="content-section">
                    <h2>2. Vetorização: Proibido Usar Loops</h2>
                    <p>Em Data Science, a Regra #1 é: <strong>Nunca use 'for loop' em DataFrames</strong>. Use
                        Vetorização.</p>

                    <div class="comparison-grid">
                        <div class="comparison-card">
                            <h4>❌ O Jeito Lento (Iterativo)</h4>
                            <div class="formula-display">
                                for i in range(len(df)):
                                df['total'][i] = df['preco'][i] * df['qtd'][i]
                            </div>
                            <p>Tempo: 10 mins (para 1M linhas). O Python processa linha por linha.</p>
                        </div>
                        <div class="comparison-card">
                            <h4>✅ O Jeito Rápido (Vetorizado)</h4>
                            <div class="formula-display">
                                df['total'] = df['preco'] * df['qtd']
                            </div>
                            <p>Tempo: 0.1 segundos. A CPU processa o bloco inteiro de memória de uma vez (SIMD - Single
                                Instruction, Multiple Data).</p>
                        </div>
                    </div>
                </section>

                <!-- CAPÍTULO 3: AUTOMAÇÃO REAL -->
                <section class="content-section">
                    <h2>3. Case de Automação: O Fim do Trabalho Manual</h2>
                    <p>Python brilha onde o Excel falha: tarefas repetitivas e complexas.</p>

                    <div class="case-study-card">
                        <h4>🏢 Cenário Real: Relatórios Diários de Filiais</h4>
                        <p><strong>Problema:</strong> Você recebe 50 arquivos Excel por e-mail toda manhã (um de cada
                            filial), precisa abrir um por um, copiar os dados para uma planilha Mestra e enviar um
                            resumo para o diretor.</p>
                        <p><strong>Solução Python:</strong> Um script que roda automaticamente:</p>
                        <ol>
                            <li>Lê a pasta onde os arquivos estão (<code>glob</code>).</li>
                            <li>Abre todos em loop e empilha num único DataFrame (<code>pd.concat</code>).</li>
                            <li>Faz o tratamento de dados e cálculos.</li>
                            <li>Envia o resumo por e-mail automático (<code>smtplib</code>).</li>
                        </ol>
                        <p>Tempo de execução: 30 segundos. Tempo humano economizado: 2 horas/dia.</p>
                    </div>
                </section>

                <!-- CAPÍTULO 4: ETL COM PYTHON -->
                <section class="content-section">
                    <h2>4. ETL Hardcore (Extract, Transform, Load)</h2>
                    <div class="example-box success">
                        <h4>🛠️ Laboratório: O Script Completo de Consolidação</h4>
                        <div class="formula-display">
                            import pandas as pd
                            import glob

                            # 1. EXTRACT: Achar todos os arquivos .xlsx
                            arquivos = glob.glob("vendas_*.xlsx")
                            tabelas = []

                            for arquivo in arquivos:
                            df_temp = pd.read_excel(arquivo)
                            # Adicionacoluna de origem para rastreio
                            df_temp['Origem'] = arquivo
                            tabelas.append(df_temp)

                            # 2. TRANSFORM: Juntar tudo
                            df_final = pd.concat(tabelas, ignore_index=True)

                            # Limpeza: Remover linhas vazias e converter datas
                            df_final = df_final.dropna(subset=['Venda'])
                            df_final['Data'] = pd.to_datetime(df_final['Data'])

                            # 3. LOAD: Salvar o consolidado
                            df_final.to_excel("Consolidado_Final.xlsx", index=False)
                            print(f"Processado {len(df_final)} linhas com sucesso!")
                        </div>
                        <p>Este script é o "feijão com arroz" da automação. Salve isso, você vai usar.</p>
                    </div>
                </section>

                <section class="content-section">
                    <h2>5. Desafio: O Error Handler</h2>
                    <p>O que acontece se um dos arquivos Excel estiver corrompido ou com senha? O script acima vai
                        quebrar e parar tudo.</p>

                    <details class="spoiler-box">
                        <summary>Ver Solução Robusta</summary>
                        <div class="spoiler-content">
                            <p>Precisamos usar blocos <code>try / except</code> (tratamento de exceção).</p>
                            <div class="formula-display">
                                for arquivo in arquivos:
                                try:
                                df_temp = pd.read_excel(arquivo)
                                tabelas.append(df_temp)
                                except Exception as e:
                                print(f"ERRO no arquivo {arquivo}: {e}")
                                # O loop continua para o próximo arquivo, não trava!
                            </div>
                            <p>Isso diferencia um script amador de um script de produção resiliente.</p>
                        </div>
                    </details>
                </section>

                <nav class="nav-bottom">
                    <a href="../index.html#avancado">[<] Voltar ao Modulo</a>
                            <a href="pandas-numpy.html">Proximo: Pandas e NumPy [>]</a>
                </nav>
    </main>
    <script src="subpage-script.js"></script>
</body>

</html>